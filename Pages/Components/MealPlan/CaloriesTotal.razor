@inject AuthenticationStateProvider AuthState
@inject IDialogService DialogService
@using UtilsFolder.ToolTip;

<MudPaper Outlined="true" Class="pa-1 rounded-pill">
    <div class="d-flex pl-3 pr-3 justify-space-between">
        <div class="d-flex align-center">
            <MudIcon Class="mr-3" Size="Size.Medium" Icon="@Icons.Filled.PieChart" />
            <MudText Typo="Typo.h6" Color="Color.Info">@Energy Kilocalorías</MudText>
            <MudIconButton OnClick="@ToggleOpen" Size="Size.Medium" Icon="@Icons.Filled.Info" />
        </div>
        <AuthorizeView>
            <Authorized>
                <div>
                    <MudTooltip Text="@InfoMessage.DailyConfiguration" Arrow="true" Placement="Placement.Right">
                        <MudIconButton @onclick="OpenDialog" Size="Size.Medium" Icon="@Icons.Filled.Settings" />
                    </MudTooltip>
                    
                </div>
            </Authorized>
        </AuthorizeView>
        
    </div>
    <MudPopover Open="_isOpen" OverflowBehavior="OverflowBehavior.FlipAlways" AnchorOrigin="Origin.TopRight" TransformOrigin="Origin.TopCenter" Paper="false">
        <DistributionComponent Energy=@Energy
                               Carbs=@Carbs
                               Proteins=@Proteins
                               Lipids=@Lipids>
        </DistributionComponent>
    </MudPopover>
</MudPaper>


@code {
    [Parameter]
    public int Energy { get; set; }
    [Parameter]
    public int Carbs { get; set; }
    [Parameter]
    public int Proteins { get; set; }
    [Parameter]
    public int Lipids { get; set; }

    public bool _isOpen = false;

    public void ToggleOpen()
    {
        if (_isOpen)
            _isOpen = false;
        else
            _isOpen = true;
    }
    private void OpenDialog()
    {
        var options = new DialogOptions { CloseOnEscapeKey = true };
        DialogService.Show<DailyConfiguration>("",options);
    }
    
}
